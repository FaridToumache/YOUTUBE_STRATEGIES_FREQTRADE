# DELTA_NEUTRAL Hyperliquid Freqtrade – How to run

* The `config-private.json` file contains 3 variables (for the docker container) `walletAddress=0x...` , `privateKey=0x...` and `privateKeyEthWallet=0x...`
* Must be keys of a **dedicated Hyperliquid account with a hot wallet** (will not work with cold wallet like Ledger because you should not get the private key out of it)
 * `privateKeyEthWallet` is the actual secret key of your hot wallet (can be found in Metamask or Rabby wallet settings) ; it is required to do spot/perp fund transfers (rebalancing). Alternatively you could not expose your wallet private key, and do spot/perp rebalancing manually
 * `privateKey` is generated by Hyperliquid in the `more->API section` ; required for sending trading orders
 * `walletAddress` is your Ethereum Hot Wallet address (it is NOT the `API Wallet Address` generated by hyperliquid at the same time as `privateKey`)
* `stake_amount` in `config.json` is indicative, and the **BOT WILL TRY TO USE ALL THE AVAILABLE USDC IN THE PERP+SPOT ACCOUNT** (see `custom_stake_amount` in `DELTA_NEUTRAL.py`).
* To run the bot:
  * Open a terminal in this folder and run `docker compose build`
  * run `docker compose up` to see terminal output and check if it works well
    * logs specific to this Delta Neutral strategy are written in file `user_data\strategies\delta_neutral.log`
  * You can then ctrl-c and run `docker compose up -d` to have it running persistently in the background
  * To close all open positions (for debug, tests, or when you stop using the bot), put `FORCE_EXIT` in `DELTA_NEUTRAL.py` to `True` and restart (run `docker compose down` then `docker compose up`), it will cleanly close all delta neutral postions quickly
* Works on 2 maximum delta-neutral positions by default (ranked by funding rate with volume as tie-breaker), each using 1/2 of the available capital (perp+spot). To change from 2, adjust values of `MAX_POSITIONS` in `DELTA_NEUTRAL.py` AND `max_open_trades` in `config.json`. MORE THAN 3 POSITIONS IS NOT SUPPORTED (but easy to add).
* Should be run on a dedicated Hyperliquid account without any open position on Perp or Spot. It is OK if there are some dusts on the Spot; this bot will also create dust.
* Supported coins are the ones in the whitelist of `config.json` file, do not add new coins without changing the code of `get_coin_info()` in `DELTA_NEUTRAL.py`.
* Overall Profit&loss of the strategy should be tracked by looking at the Hyperliquid account total perp+spot balance (under "portfolio" section -> "Total Equity"). Freqtrade will only give Short positions' Profit&loss including fundings.

* To support this project, you can use my referral link for **Hyperliquid**: [https://app.hyperliquid.xyz/join/FREQTRADE](https://app.hyperliquid.xyz/join/FREQTRADE)
* There is an alternative project to do Delta-Neutral funding farming on **Hyperliquid** called **Liminal**: [https://liminal.money/join/FREQTRADE](https://liminal.money/join/FREQTRADE)
   * (caveats of **Liminal** are: limited pool sizes, minimum of 500 USDC deposit, no rebalancing to better coins, running on someone else's account if you didn't do at least 100k volume on Hyperliquid) 

# DELTA_NEUTRAL Hyperliquid Freqtrade – quick overview

- **Strategy type:** *delta‑neutral*  
  - Simultaneously open a perpetual short and a spot long to harvest positive funding while staying market‑neutral.

- **Position management**  
  - Automatically rebalances perp and spot accounts USDC amounts for ~50/50
  - **Maximum:** uses `MAX_POSITIONS = 2` pairs at the same time ("position slots"). Can be changed by editing both `max_open_trades` in `config.json` and `MAX_POSITIONS` in `DELTA_NEUTRAL.py`.
  - **Minimum holding time:** `MINIMUM_TIME_FOR_POSITION_HOUR` is set to 120 (5 days), the minimum holding time, enough to offset opening + closing fees. This is a wild guess, did not test it or optimize anything.
  - **Exit triggers for a given pair position:**  
    - a clearly better funding/volume pair appears after the minimum holding time (`MINIMUM_TIME_FOR_POSITION_HOUR`)  
    - short's profit > 50 % or loss < −50 %, will trigger a rebalance to always stay far from liquidation.

- **Pair selection**  
  1. Filter for **funding APR ≥ 10 %** and **quote volume ≥ 2.5 M USDC**.  
  2. Rank descending by funding, then volume (`select_BEST_PAIRS`).  
  3. Open a position if the pair is in the TOP‑K list and not already held.

- **Capital & risk**  
  - **Hard stop‑loss:** −90 % (effectively disabled).  
  - **ROI limit:** 5000 % (effectively disabled).  
  - **Leverage:** fixed at `1` (no leverage). Should never be changed. Code may be updated in the future to have leverage, but not sure the risk/reward is worth it.

- **Cadence:** `timeframe = '1m'`  
  - Evaluates and acts every minute (as soon as possible for freqtrade).

- **Main loop (`bot_loop_start`)**  
  - Sanity checks, updates funding data, volumes, and active positions each cycle, with logs.  
  - Periodically logs top pairs.

- **Real order handling**  
  - In `live` mode, places spot legs via Hyperliquid API (`HL_buy_spot_market` / `HL_sell_spot_market`).  
  - In `dry_run`, simulates without sending spot orders. `dry_run` is not very usefull as it is now.

- **Utility functions**  
  - `write_log()` — resets (first call) then appends timestamped lines to `delta_neutral.log`.  
  - `REBALANCE_PERP_SPOT()` — balances USDC between Hyperliquid spot / perp accounts whenever either side drifts ±0.5 %.  
  - `_get_spot_price()` — fetches the current mid‑price for a given coin via Hyperliquid’s REST API.  
  - `get_coin_info()` — supplies tick sizes, decimal precision and spot‑pair symbol for each supported coin.  
  - `HL_buy_spot_market()` — places a market buy on Hyperliquid spot, adjusting size for dust and adding a 0.05 % buffer.  
  - `HL_sell_spot_market()` — liquidates the full spot position with an IOC limit order 5 % below last price.  
  - `record_hourly_funding_by_pair()` — records hourly funding APR snapshots in `historical_funding_rates_DB.json`.  
  - `average_funding_last_7_days()` — returns 7‑day average funding APR per pair from the JSON DB.  
  - `print_average_funding_last_7_days()` — logs the 7‑day average funding table to `delta_neutral.log`.  
  - `avg_funding_last_hours()` — computes mean funding APR over the most‑recent *n* hours.







